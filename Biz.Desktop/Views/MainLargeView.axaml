<views1:FormFactorAwareUserControl
    x:Class="Biz.Desktop.Views.MainLargeView"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:CompositeFramework.Avalonia.Controls;assembly=CompositeFramework.Avalonia"
    xmlns:converters="clr-namespace:Biz.Shared.Converters;assembly=Biz.Shared"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:infrastructure1="clr-namespace:Biz.Shared.Infrastructure;assembly=Biz.Shared"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:navigation="clr-namespace:CompositeFramework.Avalonia.Navigation;assembly=CompositeFramework.Avalonia"
    xmlns:shadui="clr-namespace:ShadUI;assembly=ShadUI"
    xmlns:toolbar="clr-namespace:Biz.Shared.ViewModels.Toolbar;assembly=Biz.Shared"
    xmlns:viewModels="clr-namespace:Biz.Desktop.ViewModels"
    xmlns:viewModels1="clr-namespace:Biz.Shared.ViewModels;assembly=Biz.Shared"
    xmlns:views1="clr-namespace:Biz.Shared.Views;assembly=Biz.Shared"
    x:Name="Root"
    d:DesignHeight="450"
    d:DesignWidth="800"
    x:CompileBindings="True"
    x:DataType="viewModels:MainLargeViewModel"
    x:TypeArguments="viewModels:MainLargeViewModel"
    mc:Ignorable="d">
    <Panel>
        <Grid ColumnDefinitions="Auto,*">
            <shadui:Sidebar
                Grid.Column="0"
                Width="220"
                MinWidth="60"
                Padding="{Binding #Toggler.IsChecked,
                                  Converter={x:Static converters:BooleanConverters.SidebarPadding}}"
                BorderBrush="{DynamicResource BorderColor30}"
                BorderThickness="0,0,1,0"
                CurrentRoute="{Binding CurrentArea}"
                Expanded="{Binding IsDrawerOpen,
                                   Mode=TwoWay}">
                <shadui:Sidebar.Header>
                    <ToggleButton
                        Name="Toggler"
                        Width="36"
                        Height="36"
                        Padding="8"
                        HorizontalAlignment="{Binding IsDrawerOpen,
                                                      Converter={x:Static converters:BooleanConverters.SidebarTogglerHorizontalAlignment}}"
                        CornerRadius="{DynamicResource LgCornerRadius}"
                        Cursor="Hand"
                        IsChecked="{Binding IsDrawerOpen,
                                            Mode=TwoWay}"
                        Theme="{DynamicResource SideTogglerTheme}">
                        <PathIcon Data="{Binding IsDrawerOpen, Converter={x:Static converters:BooleanConverters.SidebarToggleIcon}}" />
                    </ToggleButton>
                </shadui:Sidebar.Header>

                <!--  sidebar items  -->
                <ScrollViewer
                    DockPanel.Dock="Top"
                    HorizontalScrollBarVisibility="Disabled"
                    VerticalScrollBarVisibility="Auto">
                    <ItemsControl ItemsSource="{Binding SidebarHeaders}">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Spacing="0" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <TreeDataTemplate DataType="viewModels1:SidebarHeaderViewModel" ItemsSource="{Binding Children}">
                                <StackPanel Spacing="0">

                                    <shadui:SidebarItemLabel
                                        AsSeparator="True"
                                        IsVisible="{Binding Header,
                                                            Converter={x:Static ObjectConverters.IsNotNull}}"
                                        Text="{Binding Header}" />

                                    <!--  Children  -->
                                    <ItemsControl ItemsSource="{Binding Children}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Spacing="0" />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate DataType="viewModels1:SidebarItemViewModel">
                                                <shadui:SidebarItem
                                                    Command="{Binding Command}"
                                                    CommandParameter="{Binding}"
                                                    Content="{Binding DisplayName}"
                                                    IsVisible="{Binding #Root.ViewModel.IsLoggedIn}"
                                                    Route="{Binding ViewName}"
                                                    ToolTip.Tip="{Binding $parent[shadui:Sidebar].Expanded,
                                                                          Converter={x:Static converters:BooleanConverters.NullOrString},
                                                                          ConverterParameter='{Binding DisplayName}'}">
                                                    <shadui:SidebarItem.Icon>
                                                        <PathIcon Data="{Binding GeometryStyleResourceName, Converter={x:Static converters:StringConverters.AppStyleResource}, ConverterParameter='{Binding GeometryStyleResourceName}'}" />
                                                    </shadui:SidebarItem.Icon>
                                                </shadui:SidebarItem>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                            </TreeDataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <shadui:Sidebar.Footer>
                    <StackPanel />
                </shadui:Sidebar.Footer>
            </shadui:Sidebar>

            <!--  Header, Main Content, and Toolbar  -->
            <Grid
                Grid.Column="1"
                Margin="0,10,0,0"
                HorizontalAlignment="Stretch"
                ColumnDefinitions="*,Auto,Auto"
                RowDefinitions="Auto,*">

                <!--  Main Content  -->
                <controls:ReversibleTransitioningContentControl
                    Grid.Row="1"
                    Grid.ColumnSpan="3"
                    Margin="0,10,0,0"
                    navigation:SectionManager.SectionName="{x:Static infrastructure1:SectionNames.MainContentSection}">
                    <TransitioningContentControl.PageTransition>
                        <PageSlide Duration="0:00:00.2">
                            <PageSlide.SlideInEasing>
                                <shadui:EaseInOutBack BounceIntensity="Soft" />
                            </PageSlide.SlideInEasing>
                        </PageSlide>
                    </TransitioningContentControl.PageTransition>
                </controls:ReversibleTransitioningContentControl>

                <!--  Header  -->

                <!--  Title icon and text  -->
                <StackPanel
                    Grid.Row="0"
                    Grid.Column="0"
                    Margin="0,0,0,0"
                    Orientation="Horizontal"
                    Spacing="0">
                    <!--  Title icon  -->
                    <Viewbox
                        Width="28"
                        VerticalAlignment="Stretch"
                        IsVisible="{Binding CurrentPage.TitleGeometryResourceName,
                                            Converter={x:Static converters:StringConverters.NotNullOrEmpty}}">
                        <PathIcon Data="{Binding CurrentPage.TitleGeometryResourceName, Converter={x:Static converters:StringConverters.AppStyleResource}}" />
                    </Viewbox>
                    <!--  Title text  -->
                    <TextBlock
                        VerticalAlignment="Center"
                        Classes="Header"
                        IsVisible="{Binding CurrentPage.Title,
                                            Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                        Text="{Binding CurrentPage.Title}" />
                </StackPanel>

                <!--  Toolbar Buttons  -->
                <ItemsControl
                    Grid.Row="0"
                    Grid.Column="1"
                    Margin="0,0,8,0"
                    BorderThickness="0"
                    Focusable="False"
                    ItemsSource="{Binding CurrentPage.ToolbarEntries}"
                    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                    ScrollViewer.VerticalScrollBarVisibility="Auto">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" Spacing="8" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.DataTemplates>
                        <DataTemplate DataType="toolbar:ToolbarEntry">
                            <Button
                                Padding="11,7"
                                VerticalAlignment="Stretch"
                                BorderBrush="{DynamicResource BorderColor}"
                                BorderThickness="1"
                                Command="{Binding Command}"
                                CornerRadius="6"
                                Focusable="False"
                                IsVisible="{Binding IsVisible}">
                                <StackPanel Orientation="Horizontal" Spacing="5">
                                    <PathIcon
                                        VerticalAlignment="Center"
                                        Data="{Binding Geometry}"
                                        IsVisible="{Binding Geometry,
                                                            Converter={x:Static converters:ObjectConverters.NonNullToTrue}}" />
                                    <TextBlock
                                        VerticalAlignment="Center"
                                        Classes="Small"
                                        IsVisible="{Binding Text,
                                                            Converter={x:Static converters:StringConverters.NotNullOrEmpty}}"
                                        Text="{Binding Text}" />
                                </StackPanel>
                            </Button>
                        </DataTemplate>
                        <DataTemplate DataType="toolbar:ToolbarSeparator">
                            <Border
                                Width="25"
                                VerticalAlignment="Stretch"
                                Background="Transparent"
                                BorderThickness="0" />
                        </DataTemplate>
                    </ItemsControl.DataTemplates>
                </ItemsControl>

                <!--  Profile button and menu on right  -->
                <Menu
                    Grid.Row="0"
                    Grid.Column="2"
                    Margin="20,0,8,0"
                    Padding="0"
                    Classes="Single">
                    <MenuItem
                        Padding="0"
                        HorizontalAlignment="Stretch"
                        shadui:MenuItemAssist.PopupHorizontalOffset="0"
                        shadui:MenuItemAssist.PopupPlacement="BottomEdgeAlignedRight"
                        shadui:MenuItemAssist.PopupVerticalOffset="6"
                        Classes="NoPressedAnimation"
                        CornerRadius="9999">
                        <MenuItem.Header>
                            <Border
                                Padding="4"
                                BorderBrush="{DynamicResource BorderColor}"
                                BorderThickness="1"
                                CornerRadius="9999">

                                <shadui:Avatar
                                    CornerRadius="9999"
                                    Fallback="CN"
                                    Source="avares://Biz.Shared/Assets/user.png" />

                            </Border>
                        </MenuItem.Header>
                        <shadui:MenuItemAssist.Label>
                            <Grid
                                Width="220"
                                HorizontalAlignment="Stretch"
                                ColumnDefinitions="Auto *">
                                <shadui:Avatar
                                    Width="36"
                                    Height="36"
                                    Margin="0,0,8,0"
                                    CornerRadius="9999"
                                    Fallback="CN"
                                    Source="avares://Biz.Shared/Assets/user.png" />
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Classes="Small" Text="shadui" />
                                    <TextBlock
                                        Margin="0,-4,0,0"
                                        Classes="Caption"
                                        Text="m@example.com" />
                                </StackPanel>
                            </Grid>
                        </shadui:MenuItemAssist.Label>
                        <Separator />
                        <MenuItem
                            Command="{Binding OpenUrlCommand}"
                            CommandParameter="https://github.com/accntech/shad-ui?tab=readme-ov-file#readme"
                            Header="About">
                            <MenuItem.Icon>
                                <Viewbox Width="16" Height="16">
                                    <TextBlock
                                        Classes="LucideIcon"
                                        Foreground="{DynamicResource MutedColor}"
                                        Text="&#57599;" />
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem
                            Command="{Binding OpenUrlCommand}"
                            CommandParameter="https://github.com/accntech/shad-ui?tab=readme-ov-file#readme"
                            Header="Readme">
                            <MenuItem.Icon>
                                <Viewbox Width="16" Height="16">
                                    <TextBlock
                                        Classes="LucideIcon"
                                        Foreground="{DynamicResource MutedColor}"
                                        Text="&#57443;" />
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem
                            Command="{Binding OpenUrlCommand}"
                            CommandParameter="https://github.com/accntech/shad-ui"
                            Header="Source repository">
                            <MenuItem.Icon>
                                <Viewbox Width="16" Height="16">
                                    <TextBlock
                                        Classes="LucideIcon"
                                        Foreground="{DynamicResource MutedColor}"
                                        Text="&#57862;" />
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator />
                        <MenuItem
                            Command="{Binding OpenUrlCommand}"
                            CommandParameter="https://github.com/accntech/shad-ui?tab=MIT-1-ov-file#readme"
                            Header="MIT License">
                            <MenuItem.Icon>
                                <Viewbox Width="16" Height="16">
                                    <TextBlock
                                        Classes="LucideIcon"
                                        Foreground="{DynamicResource MutedColor}"
                                        Text="&#57874;" />
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem
                            Command="{Binding OpenUrlCommand}"
                            CommandParameter="https://github.com/accntech/shad-ui?tab=coc-ov-file#readme"
                            Header="Code of Conduct">
                            <MenuItem.Icon>
                                <Viewbox Width="16" Height="16">
                                    <TextBlock
                                        Classes="LucideIcon"
                                        Foreground="{DynamicResource MutedColor}"
                                        Text="&#58071;" />
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem
                            Command="{Binding OpenUrlCommand}"
                            CommandParameter="https://github.com/accntech/shad-ui?tab=security-ov-file"
                            Header="Security">
                            <MenuItem.Icon>
                                <Viewbox Width="16" Height="16">
                                    <TextBlock
                                        Classes="LucideIcon"
                                        Foreground="{DynamicResource MutedColor}"
                                        Text="&#57692;" />
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem
                            Command="{Binding OpenUrlCommand}"
                            CommandParameter="https://github.com/accntech/shad-ui/activity"
                            Header="Activity">
                            <MenuItem.Icon>
                                <Viewbox Width="16" Height="16">
                                    <TextBlock
                                        Classes="LucideIcon"
                                        Foreground="{DynamicResource MutedColor}"
                                        Text="&#57400;" />
                                </Viewbox>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator />
                    </MenuItem>
                </Menu>
            </Grid>
        </Grid>
        <shadui:ToastHost Manager="{Binding ToastManager}" />
    </Panel>
</views1:FormFactorAwareUserControl>